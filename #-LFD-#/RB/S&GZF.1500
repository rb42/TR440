				--	S&GZF		--
				--			--
				---S&GZF, ZEICHENTRANSPORT--

S&GZF.=	SEGM,
	EINGG	(S&GZF,S&GZFA,S&GZFN,S&GZFE),
	STRUKT	(3,RUECK),
	EINGG	(S&GZFU,S&GZFM,S&GZFO),
	INDEX	0	(X1,X2,XZO,XLZP,XNUM,XAS,XLZ,XLW,XZPUF,XZE,XH1,XH2,XH3),
XVBL=	GLCH	XZE,
	N	(''*021 S&GFZ(001500) 25.08.78      ''),
	TBC	RUECK		--RUECKKEHRADR.--
	BCI	BASI		--EIGENE INDEXBASIS--
	BCL	MERK,
	SL	2R	8,
	S	F0		--KEIN ANFANGSAUFRUF VORWEG --
NEUZ=	LZL	0	2,
	SLN	GZD	54	:FRENMDSTRING IN DATEI UND NICHT ZU ENDE;
	SLN	2	4	--MATERIAL NICHT ZU ENDE--
	S	EXIT,
G11=	TXX	XZE	XLZP	: HW -ANZAHL ZEILEPUFFER HW -WEISE,SONST -S;
	TCB	ALZP,
	XC	XZPUF		: ANFADR. ZEILENPUFFER;
	BH	ZEILENENDE,
	LR	3Q		:ZEILEN-LESEPUFFERENDE-VERGLEICHSWERT;
	SL	MLES120	3	:NUMERIERUNG EXTERN VORNE ;
MLES05=	SL	MLES80	7	:ABLAGE H-W-WEISE;
	HXP	-2	XZPUF,
MLES10=	BNZ	XLZ	XLW,
MLES20=	SI	MLZEILEND 		: ENDE-ZEICHEN LIEGT VOR ;
MLES30=	SH	AUK	8,
	SH	ZUKL	8	:EIN ZEICHEN ANGEFUEGT;
	SZX	MLES10	XZE,
	EZ	CQ	XZPUF	:1 GW ABGELEGT;
	VBC	ZPUFEND,
	SXGG	MLES50		: ZEILENPUFFER IST JETZT VOLL;
	ZX	-5	XZE,
	S	MLES10		: BEGINN NAECHSTES GW FUELLEN;

MLZEILEND=	SU	ULPPRUEF 	: PRUEFEN OB LESEPUFFERENDE;
	S	MLES20		:LESEPUFFER NEU GEFUELLT;
	S	MLES30		:DATEIEINGABE, NL IM SATZ;
	TXX	XH2	XZE	: MATERIALENDE ODER ZEILENENDE ;
	SH	QUL	8,
	SZX	-1R	XH2,
	EZ	CQ	XZPUF	:LETZTES GW ABGELEGT;
MLES40=	VBC	ALZP,
	XC	XH2,
	HBPX	2	XH2,
	HBA	5,
	RX	BC	XZE	:ANZAHL OKTADEN IN ZEILENPUFFER;
	S	MLES110		: ENDEBEHANDLUNG;

MLES50=	BNZ	XLZ	XLW	: 1.ZEICHEN NACH ZEILENPUFFER VOLL ;
MLES60=	SN	F9		: ZEICHEN KEIN 'NL' / ZEILE ZU LANG;
	SU	ULPPRUEF,
	S	MLES60		:LESEPUFFER NEU GEFUELLT;
	S	F9		: DATEI SATZ ZU LANG;
	ZX	1	XZE,
	XB	XZPUF,
	S	MLES40		:ZEILEN+ZEILENPUFFERENDE;

MLES70=	E	C2	XZPUF,
	HXP	1	XZPUF	: EIN ZEICHEN ABGELEGT;
MLES80=	BNZ	XLZ	XLW,
MLES85=	SI	MLES100		: ENDEZEICHEN AUFGETRETEN;
MLES90=	SZX	MLES70	XZE,
	S	F9		: ZEILE ZU LANG;
MLES100=	SU	ULPPRUEF,
	S	MLES85		:LESEPUFFER NEU GEFUELLT;
	S	MLES90		:DATEIEINGABE MIT 'NL' IM SATZ;
	VXX	XLZP	XZE	: ENDE ZEILE ,LAENGE BESTIMMT;

MLES110=	SXN	MNUM		:NUM.AUSFUEHREN;

MLEERZ=	ZX	0	XZE,
	S	MNUM		:LEERE ZEILE LIEGT VOR;


				: NUMERIERUNG EXTERN VORNE - AUSBLENDEN;
MLES120=	ZX	-6	XH3,
	B	NINF,
	CN	BX		:NUMMER.-UND AUSBLENDLAENGE NEGATIV NACH X1,X2;
MLES130=	SZX	MLES140	X2	:AUSBLENDUNG NOCH NICHT ZU ENDE;
	S	2R,
	SH	QUL	8,
	SZX	-1R	XH3	:NUMMER LINKSBUENDIG;
	CQ	NUM,
	S	MLES05		: NUMERIERUNG ABGELEGT UND AUSGEBLENDET;
MLES140=	BNZ	XLZ	XLW,
MLES145=	SI	MLES160		:ENDEZEICHEN AUFGETRETEN;
	SL	MLES150	2	:NUMERIERUNG SAMMELN;
	SZX	MLES130	X1	:NOCH AUSBLENDEN VOR NUMMER;
	LZL	2	0	:NUM.ANF.;
MLES150=	SZX	2R	XH3,
	S	MLES130		:AUSBLENDEN NACH NUMMER;
	SH	AKU	8,
	SH	ZUKL	8,
	S	MLES130		:EIN NUMERIERUNGSZEICHEN DAZU;
MLES160=	SU	ULPPRUEF,
	S	MLES145		:NEUE PUFFERFÜLLUNG;
	S	MLES145+1 	:DATEIEINGABE MIT 'NL';
	HXP	-1	X2	:ENDE MAT.;
	HBC	NINF+1,
	SXN	F7		:ZEILE ZU KURZ;
	S	F7		:LEERE ZEILE;
GZD=	XBA	VBDAT,
	SSR	253	10,
	ST	MLES250	2A	:SATZ ZU LANG*STRING AUS DATEI;
MLES205=	SBA	1,
	TRX	A	XZE,
	B	ENDNUM,
	SK	MGZFE		:BEREICH UEBERSCHRITTEN;
	ST	MLES220	2H	:LETZTER SATZ;
	ST	MLES230	2Q	:BANDENDE ERREICHT;
MLES210=	TXR	A	XZE,
	TCB	VBDAT+8,
	XC	XZPUF,
	SK0	MLES260		:SATZ LNG=0;
	HBPX	2	XZE,
	MAB	B	0	:LETZTE WORT IM SATZ;
	XC	XLW,
	LA	F,
	BAR	5,
	SK	FDAT		:FEHLER IM OKT.-ZAEHLER;
	TRX	H	XLZ,
	HBPX	6	XZE,
MLES215=	XC	XZE,
	SLN	MNUM	37	:NUMERIER. OHNE UMSPEICHERN REAL.;
	HXX	XZO	XLZ,
	B	ZEILENENDE,
	CNZ	XLZ	XLW	:'NL' HINTER SATZ ABLEGEN;
	SU	UOADR,
	C	LESPUEND,
	TXX	XLZ	XZO,
	TXX	XLW	XZPUF,
	S	G11		:UMSPEICHERN;
MLES220=	LZL	4	0,
	XBA	VBDAT,
	SSR	253	14,
	S	MLES210		:DATEI ABGESCHLOSSEN;
MLES230=	ZT3	VBDAT+6,
	XBA	VBDAT,
	SSR	253	21,
	SNL	MLES210	2	:BANDWECHS;
	XB	XZE,
	SXK	GZD		:NOCH KEIN SATZ BEI BANDENDE TRANSPORTIERT;
	XBA	1,
	TBC	VBDAT+7,
	XBA	VBDAT,
	SSR	253	11	:SKIP;
	BA	1,
	SBC	VBDAT+10,
	S	MLES210,
MLES250=	STN	F9	2Q	:KEIN BANDENDE;
	LZL	2	0,
	ZTR	3A,
	S	MLES205,
MLES260=	XC	XLW,
	ZX	0	XLZ,
	S	MLES215		:LNG=0 OHNE 0-Z;

				---FEHLERBEHANDLUNG--
F0=	XBA	VBL616,
	SSR	6	16	--FEHLERTEXT AUSGEBEN--
F0A=	AQ	MASKE		--ALARM ERZEUGEN, DA KEIN ANF.AUFRUF VORWEG--
	LR	3D,
	SE	RUECK,
F9=	BH	VBDAT+10 	:AKT.SATZPOS.;
	MA	1		:ZEILENPUFFER ZU KURZ;
F8=	MA	1		--SATZELEMENTART IN DATEI FALSCH--
F7=	MA	1		-- ZEILE FUER EXT.NUM. ZU KURZ --
F6=	MA	1		-- POSITIONIERUNG KONNTE NICHT ERFOLGEN--
F5=	MA	1		--INT. NUM-ANGABEN UNZUL. --
F4=	MA	2		--EXT. NUM-ANGABEN UNZUL. --
F2=	MA	1		-- ABW. ODER DB.-FEHLER --
F1=	MA	1		:VBL.FALSCH;
	N	0,
	KE	GZFEHL,
	BCI	BASI,
	BCL	MERK,
	RT	QD,
	RT	AQ,
	TBC	RUECK-1,
	B	RUECK-1,
	SH	AKU	24	: RUECK HAT TK1;
	SE	FADR,

FDAT=	B	VBDAT+10,
	S	F8,
SSR1=	QCR	SSRQCR,
	S	F2,

				---S&GZF, NUMERIERUNG UND ENDEBEHANDLUNG--
MNUM=	B	NINF,
	ST	FERTIG	0A	:KEINE NUMERIERUNG;
	ST	INTN	1A	:INTERNE NUM.;
	ST	EXTN	2A	:EXTERNE NUMERIERUNG;
STAN=	SL	MNUM90	5	:BEI FS,STD-NUM.+AUSBLENDUNG;
	BH	VBDAT+10,
	ZTR	1H		:DATEI,-STD-NUMERIER.;
	CH	NUM,
	S	MNUM100,

EXTN=	SL	FERTIG	3	:NUMERIERUNG EXTERN VORNE BEREITS ERLEDIGT;
	SL	MNUMCOB	1	:COBOL NUM.;
	RX	ANC	XZE	:ANZ.OKT.OHNE AUSBLENDUNG;
	SXK	F7		:AUSBLENDUNGSFELDLAENGE MICHT ERREICHT;
MNUM10=	TXX	XH2	XNUM,
	SXGG	STAN		:NUMMERNFELD NICHT VORH. NUR AUSBLEND;
	SL	MNUM40	7	:NUM.-HW-WEISE HINTEN;
	LR	1AQ,
	XB	XZE,
	HBC	NINF,
	SXKG	MNUM15,
	R	BQ	B,
	DVD	K6		:ERMITTELN RE.GW-NUMMER FUER NUMER.;
	SH	QUL	3,
MNUM15=	RT	HQ,
	SH	AUL	1,
	A2	ALZP		:FW-ADR. NUMERIERUNG;
	R	MCFU	A,
	BZ	0,
	R	MCFU	H,
	SH	ZUL	0	:NUMER. LINKSBUEND.IN A-R;
	HXP	6	XH2,
	SXKG	MNUM20		:NUMERIER.6-STELLIG;
	SHB	L	3,
	R	MC	B,
	SH	AU	0,
	R	MC	B,
	SH	AUL	0	:IRRELEV.ZEICHEN ENTF.;
MNUM20=	C	NUM,
	S	FERTIG		: ENDE EXTERNE NUM. ;

MNUMCOB=	RX	A	XZE,
	SXK	F7		:COBOL NUMERIERUNG, NINF IN A-R ;
	R	B2V	AL,
	SN0	MNUM10		:COBOL NUM. HINTEN;
	ZX	-5	XH1,
	ZX	-6	XH2,
	TCB	ALZP,
	SL	MNUM50	7	:COB. HW-WEISE VORN;
	MAB	B	0,
	S	MNUM20		:COBOL NUM.-OKTADENWEISE VORN ;

MNUM40=	ZX	-5	XH1	:NUMERIERUNG HW-WEISE-ABLAGE, XH2 ENTHAELT NUM ;
	TCB	ALZP,
	HBC	NINF,
	HBPX	1	XZE	:IN B-R ADR. 1.NUMMERNZEICHEN;
MNUM50=	VBA	1,
	LR	3Q		: BEGINN SAMMELSCHLEIFE;
MNUM60=	SZX	MNUM80	XH2,
	SH	QUL	8,
	SZX	-1R	XH1	:LINKSBUENDIG SCHIFTEN;
MNUM70=	CQ	NUM,
	S	FERTIG,
MNUM80=	MAB	B2	1,
	SH	AKU	8,
	SH	ZKUL	8	:EIN NUMMERNZEICHEN ENGEFUEGT;
	SZX	MNUM60	XH1	:NOCH KEINE 6 NUMERIERUNGSZEICHEN;
	S	MNUM70		: 6 NUMERIERUNGSZEICHEN GESAMMELT;

MNUM90=	BA	10		: -STD- NUMERIERUNG MIT AUSBÖENDUNG BEI FREMDSTRING;
INTN=	AC	NUM		: STANDARDNUMERIERUNG FREMDSTR,;

FERTIG=	BH	W0		:ZEICHENADR. NEXT LINE;
	SL	MNUM100	5,
	BH	VBDAT+10,
MNUM100=	BQ	NUM		:ZEILENNR. INQ-R;
	TXR	A	XZE	:ZEICHENZAHL;
	KE	GZF,
	BCI	BASI,
	BCL	MERK,
	MA	1,
	SE	RUECK		:NORMALAUSGANG;

				---S&GZF , ENDAUFRUF, SPEZIELL FUER DATEIEN--
S&GZFE.=	TBC	RUECK		--RUECKKEHRADR.--
	BCI	BASI,		--EIGENE INDEXBASIS--
	BCL	MERK,
	KE	GZFE,
	SNL	EXIT	8	:KEIN ANFANGSAUFRUF VORHANDEN;
	SL	EXIT	45	:MATER.ENDE;
MGZFE=	LZL	4	0,
	XBA	VBDAT,
	SSR	253	14	:DAT.ABMELDEN;
EXIT=	ASP	0/B,
	KE	GZAUS,
	BCI	BASI,
	BCL	MERK,
	SE	RUECK,

				---S&GZFN, NUMERIERUNGSMODUS EINSTELLEN--
S&GZFN.=	TBC	RUECK		--RUECKKEHRADR.--
	BCI	BASI		--EIGENE INDEXBASIS--
	BCL	MERK,
	KE	GZFN,
	SLN	FN	8	:ANF.AUFR. FEHLT;
MGZFN=	CU	NINF,
	BAR	0,
	C	NUM,
	ST	RET	0H	-- KEINE NUMERIERUNG --
	ST	INT	1H	-- INTERNE NUMERIERUNG --
	ST	EXT	2H	-- EXTERNE NUMERIERUNG --
STD=	SLN	RETA	5,
	BA	10,
	C	NINF		--STANDARD-NUMERIERUNG --
RET=	SLN	2	5	:INFORMATION AUS DATEI;
	S	RETB,
RETA=	BZ	ALZP,
	SLN	2	37	--WEDER HW.ABLAGE NOCH NUMERIERUNG VORNE --
	RT	AQ,
	C	VBDAT+8		--PUFFERANG.FUER DATEI-MANIPIL.--
RETB=	BA	0,
	S	EXIT,
INT=	R	TCB	HL,
	RT	HQ,
	KDFR	6,
	SI0	F5		--FALSCHE NUMERIERUNG --
	C	NINF		--SCHRITTWEITE--
	R	BQ	B,
	KDFR	6,
	SB	NINF,
	C	NUM		--SNFANGWERT -SCHRITTWEITE --
	S	RET,
EXT=	R	TCB	HL,
	SXN	2R,
	LZL	3	0	--NUMER. AM ANFANG --
	VBA	2,
	SXGG	COBN		--COBOLNUMERIERUNG--
	R	TCB	QL,
	RT	HQ,
	KDFR	6,
	SI0	F4		--FALSCHE NUMERIERUNG--
	C2	NINF+1		--ABSCHNITTSLAENGE IN OKTADEN--
	R	BQ	B,
	KDFR	6,
	SI0	F4		--FALSCHE NUM.--
	SBA	1		--IRRELEV. ZEICHENANZ. --
	C2	NINF,
	SB2	NINF+1,
	TRX	A	XNUM	:NUM.ABSCHNITTSLAENGE NEG. ;
	SXKG	RET,
	S	STD,
COBN=	LZL	1	0,
	SXI	2R,
	XBAN	6,
	TBC	NINF,
	ZX	-6	XNUM,
	TBC	NINF+1,
	S	RET,

FN=	S	F0,

				---S&GZFA, INITIALISIERUNGS- AUFRUF--
S&GZFA.=	TBC	RUECK		--RUECKKEHRADR.--
	BCI	BASI		--EIGENE INDEXBASIS--
	BCL	MERK,
	KE	GZFA,
	TRX	A	XVBL,
SGZVIER=	E	BQB	XVBL,
	C	FADR		--FEHLERADR.--
	SXR	VF		--VBL FALSCH--
	LZL	85	123467,
	LC	AAP		:INITIALISIERUNG MERKL. +LESEPUFFERADRESSE;
	LA	23,
	SI0	2R,
	LZL	7	0	--ABLAGE IN HALBWORTE --
	R	B	Q,
	SH	AU	8,
	LA	F		--MODUS--
	SI0	GEBIET		--LESEN AUS GEBIET--
	BAR	1,
	SI	PRSP		:LESEN AUS PROG.SPEICHER;
	BA	2,
	SI	DATEI		:LESEN AUS DATEI;
VF=	TXR	Q	XVBL	--FALSCHER VBL--
	S	F1,

				---S&GZFA, TRANSPORT AUS GEBIET--
GEBIET=	MAB	B2	5,
	SH	AUL	1,
	C2	VB368+5		:1/8-SEITENTRANSPORTLAENGE ;
	SH	AUL	8,
	SBA	2,
	RT	AQ		:REL.ADR. LETZTES LESEPUFFER-GW;
	MAB	BU	3,
	CU	VB368+2		:EINGABEGEBIETSNAME;
	MAB	BU	2,
	C2	EAO		:FS-ENDADRESSE ;
	XC	XH3		:ADR. DER FS-ANFANGSADR.. ;
	MAB	TCB	4,
	TBC	AAP		:LESEPUFFER-ANF-ADR.;
	TBC	VB368+8,
	R	HBC	Q,
	TBC	ALPUFEND 	:LESEPUFFER-ENDADRESSE;
	SH	AUL	2,
	R	TCB	A,
	SHB	R	10,
	HBA	1,
	XC	XAS		:NR. LETZTE 1/8-SEITE +1 ;
	SH	AU	34,
	C2	VB368+4		:NUMMER DER 1. ACHTELSEITE GEBIETSRELATIV;
	RX	ANC	XAS	:ANZAHL ALLER 1/8-SEITEN;
	SU	UFUELL		:ERSTE LESEPUFFERFUELL.;
MGEB10=	E	B2	XH3,
	C	HILF,
	R	BQ	A	:FS-ANF.ADR. RESERV;
	SU	UBNZADR		:LESEADR.;
	B2	EAO,
	SH	AQUK	22,
	RT	HQ,
	SK	MGEB47		:FREMDSTR,KLEINER 1 ZEICHEN;
	S	MGEB30		:STRING-ANFANGSBEHANDLUNG,ERMITTELN 1. ZEILE;
MGEB20=	SU	UOADR,
	C	HILF		:NEUE ANFANGSADRESSE BEI FUEHRENDEN IG'S;
MGEB30=	BNZ	XLZ	XLW,
	SI0	MGEB20		:FUEHRENDES IG UEBERLESEN;
	S	MGEB45,
MGEB40=	BNZ	XLZ	XLW,
MGEB45=	BAR	'AF',
	SI	MGEB40		:BISHER NUR LEERZEICHE IN 1.ZEILE;
	B	ZEILENENDE,
	SN	MGEB50		:1.RELEVANTES ZEICHEN IN 1.ZEILE;
	SU	ULPPRUEF,
	S	MGEB45		:NEUE LESEPUFFERFUELLUNG;
	N	0,
	SLN	FIN	4	:1.ZEILE WAR IRREL.;
MGEB47=	BA	1,
	LZL	4	0,
	S	EXIT		--EM ERR.--
MGEB50=	LZL	0	4,
	B	HILF,
	SU	UBNZADR		:LESEPEG. 1.ZEICHEN NACH FUEHR. IG'S;
FIN=	M	XVBL,
	BQB	6		:ANF.ADR.+LNG ZEILENPUFFER;
	R	TCB	AL,
	TBC	ALZP		:ANFANGSADR. ZEILENPUFFER;
	LA	2,
	SH	AU	1,
	C2	ALZP+1		:PUFFERLNG BEI DAT.;
	SH	AUL	1,
	R	HBC	A,
	VBA	2,
	TBC	ZPUFEND		:ADR.LETZTES ZEILENEPUFFER-GW;
	ZX	-5	XLZP,
	SLN	2	7,
	TRX	QN	XLZP	:NEG.ZEILPUFLNG BEI HW-ABL. SONST -5;
	M	XVBL,
	BQ	4,
	MAB	BU	2,
	S	MGZFN		:NUMERIERUNG EINSTELLEN+RUECKKEHR;

				---S&GZFA,TRANSPORT AUS PROGRAMMSPEICHER--
PRSP=	MAB	B2	5,
	XC	XH3		:VERW.AUF FS-ANF.ADR.;
	SU	UBNZADR,
	BD	TEXTENDE,
	BH	MASKE,
	XBA	2,
	E	TDM	XLW	:TEXTENDE SUCHEN;
	SAT	F1		:KEIN ENDE GEFUNDEN;
	XC	XLW		:ADR. LETZTES STRING-GW;
	MAB	BQ	0,
	RT	HD,
	SH	ZUL	8,
	LA	F,
	SN	MPRSP10+1,
	HXP	-2	XLW,
	HXP	5	XLZ	:ENDE NOCH IM LETZTEN GW;
	S	MPRSP20,
MPRSP10=	HXP	1	XLZ,
	SH	ZUL	8,
	LA	F,
	SN	MPRSP10		:NOCH KEIN ENDE GEFUNDEN;
MPRSP20=	SU	UOADR,
	C2	EAO		:FS-ENDE LETZTES Z.;
	SU	UPRSPE		:NL-TAUSCH;
	S	MGEB10,

				---S&GZFA, TRANSPORT AUS DATEI--
DATEI=	E	B	XVBL,
	LA	F		--GZ IN A--
	C2	W3,
	BAR	6,
	XB	XVBL,
	SG	FD,
	BA	7,
	SG	D0,
	MFU	XVBL,
	B	14,
	STN	2	3A	--PASSWORT UNGUELTIG--
	C	VBDAT+12 	--PASSWORT--
D0=	MAB	BZ	8,
	CZ	VBDAT+2		--DBN UND DATEIKENNZEICHEN--
	ZT2	VBDAT+4,
	B2	W2,
	SN0	ISOFF,
	BA	2,
	C2	VBDAT+1,
	XBA	VBDAT,
	SSR	253	19,
	B	VBDAT+18,
	LA	T,
	BAR	1,
	SK	F8,
	BA	2,
	C	VBDAT+6		--BETRIEBSART LESEN--
	XBA	VBDAT,
	SSR	253	9	--EROEFFNUNG DATEI--
ISOFF=	LZL	0	5	--LESEN AUS DATEI--
	M	XVBL,
	B	4,
	ST	DATBER	2A	--DATEIBEREICH--
	C	VBDAT+6		--SATZRELETIVBEZUG--
	MAB	B	12,
	STN	2	2A,
	SU	DEZTET,
	CB	VBDAT+10 	--SATZPOSITION--
BISEND=	B	HONUM,
	C	ENDNUM,
D1=	XBA	VBDAT,
	SSR	253	11	--SATZPOSITIONIERUNG--
	RT	AD,
	SN0	F6		:POSITIONIEREN GING NICHT;
	S	FIN,

FD=	R	BQ	B,
	S	F1		:VBL.F;
DATBER=	BA	1,
	ZTR	3A		--T=3--
	C	VBDAT+6		--SATZRELATIVBEZUG--
	MAB	B	12	--ANF-SATZPOS--
	STN	2	2A,
	SU	DEZTET,
	STN	FD	1A,
	SI0	FD,
	SBA	1,
	CB	VBDAT+10 	--ANF-SATZPOSITION--
	B2	W3,
	BAR	8,
	SG	BISEND,
	MAB	B	4	--END-SATZPOSITION--
	STN	2	2A,
	SU	DEZTET,
	STN	BISEND	1A,
	SI0	BISEND,
	C	ENDNUM		--LETZTER SATZ--
	S	D1,

DEZTET=	RT	AQ		--BEREICH IN DEZIMALTZETTRADEN--
	KDFR	8,
	MU	S	0,

				---FUELLEN DES LESEPUFFERS, KENNZEICHNEN DES ENDES, POSITIONIEREN--
UFUELL=	TXR	A	XAS,
	SXKG	MFUE30		:EINGABE BEREITS IM LESEPUF.,ENDE-TAUSCH;
	VBC	VB368+5,
	XC	XAS		:VERBLEIBENDE 1/8-SEITEN;
	SXGG	2R,
	C2	VB368+5		:LETZTE;
	XBA	VB368,
	SSR	3	68,
	TCB	VB368+4,
	R	B	B,
	SH	AUL	8,
	C2	GEB		:ANF.ADR IM LESP;
	HBC	VB368+5,
	TBC	VB368+4		:NAECHSTE 1/8-SEITENNUMMER;
	SHB	L	8,
	TBC	LESPUEND+1 	:NEUE GEB.REL.ADR. 1.ZEICHEN NACH LESEPUFFER;
	XB	XAS,
	SXKG	MFUE20		:FS-ENDE LIEGT IM LESP.;
	MCF	ALPUFEND,
	B	0		:LESP.ENDE;
	LA	E,
	VEL	ZEILENENDE 		:ENDE-ZEICHEN SETZEN;
	MAB	BC	0,
	LA	F,
MFUE10=	BC	LZEICHEN 	:LETZT.ZEICH.MIT ALTEM LETZT.ZEICHEN VERTAUSCHEN;
	TXX	XLZ	XZO,
	TCB	AAP,
	XC	XLW		:NEUER LESEPEGEL AUF PUF.ADR.;
	MU	S	0,
MFUE20=	B2	EAO		:FS-ENDADR.;
	SU	UBNZADR,
UPRSPE=	TXX	XH1	XLZ,
	TXX	XH2	XLW,
	BNZ	XLZ	XLW,
	BR	ZEILENENDE,
	CNZ	XH1	XH2	:LETZT.ZEICHEN MIT 'NL' ERSTEZT;
	SU	UOADR,
	C	LESPUEND 	:ENDADR.BESTIMMT;
	RT	AH,
	S	MFUE10		:AUSTAUSCHZEICHEN;
MFUE30=	BH	ZEILENENDE,
	B	LZEICHEN,
	MU	SI	0	:LETZTES FS-ZEICHEN AUCH 'NL';
	B2	EAO,
	SU	UBNZADR,
	B	LZEICHEN,
	MU	S	0	:RUECKPOSIT.+LETZTES Z.;

				---S&GZFU,UMSCHALTEN AUF NEUE QUELLE,RETTEN AKTUELLE LESEPOSITION--
S&GZFU.=	TBC	RUECK,
	BCI	BASI,
	BCL	MERK,
	KE	GZFU,
	SU	RETT,
	XB	XVBL,
	S	SGZVIER,

RETT=	TRX	A	XVBL	:NEUE VBL;
	E	B	XVBL	:ANZ-1 GW D VBL;
	LA	F,
	SH	AL	1,
	R	MC	A,
	E	B	XVBL,
	C2	AVBL		--ADR ALT VBL--
	B	HONUM,
	C	ENDNUM,
	BA	0,
	C2	W2,
	MC	AVBL,
	B	2,
	STN	WAS	1A,
	LA	2,
	SU	DEZTET,
	A	NUM,
	AA	1,
	ML	('1C25C2684977'/1),
	SH	ZL	4,
	KFLD	13,
	RT	AQ,
	ZTR	1A,
	MC	AVBL,
	C2	2,
WAS=	MC	AVBL,
	B3	1,
	SH	A	8	--ARBEITSSCHLUESSEL--
	SI0	G,
	BAR	1,
	SI	P,
	BA	2,
	SN	VF		--FALSCHER VBL--
	S	D,
G=	B2	VBDAT+1,
	MC	AVBL,
	C2	16,
	HBA	10,
	S	SECHS,
P=	B2	VBDAT+1,
	MC	AVBL,
	C2	8,
	HBA	5,
SECHS=	B2	W1,
	MAB	C2	0,
	MU	S	0,
D=	B2	VBDAT+1,
	MC	AVBL,
	C2	18,
	MAB	BH	4,
	B	VBDAT+10,
	ZTR	1A,
	STN	2R	2H	:KEIN BEREICH;
	AA	1,
	MAB	C	8	:SPOSA NEU MIT TK1;
	ST	DE	2H	:BEREICH ERL.;
	MAB	ZT3	-8	:SPOSA GILT;
	BA	1,
	MAB	C2	1	:SRB =1 ,DA KEIN BEREICH;
DE=	MU	S	0,

				---S&GZFO, UMSCHALTEN AUF EROEFFNETE QUELLE,OHNE RETTEN AKT. POSITION--
S&GZFO=	TBC	RUECK,
	XBA	1,
	TBC	W2,
	C2	AVBL,
	RT	AH		--ADRESSE RETTEN--
	MC	AVBL,
	B2	1,
	LA	F,
	SH	AL	1,
	A2	AVBL,
	R	MC	A,
	B2	0,
	C2	VBDAT+1		--ALTE STROMNUMMER--
	B	HONUM,
	C	ENDNUM,
	RT	AH,
	S	S&GZFA+1,

				---S&GZFM, UMSCHALTEN AUF EROEFFNETE QUELLE,RETTEN AKT POSITION--
S&GZFM.=	TBC	RUECK,
	BCI	BASI,
	BCL	MERK,
	KE	GZFM,
	SU	RETT,
	BA	1,
	C2	W2,
	E	B	XVBL,
	LA	F,
	SH	AL	1,
	R	MC	A,
	E	B2	XVBL,
	C2	VBDAT+1,
	XB	XVBL,
	S	SGZVIER,

				---S&GZF -UNTERPROGRAMME --
ULPPRUEF=	CQ	VHGW1,
	SU	UOADR,
	C	W0		:GEBREL.ZEICHENADR.NAECHSTES ZEICHEN;
	BQ	VHGW1,
	BH	LESPUEND,
	SN	MPP20		:KEIN LESEPUFFERENDE;
	SLN	MPP25	5	:DATEI;
	XB	XAS,
	SXG	MPP10,
	SL	MPP20	4	:AUSG.3,MATERIALENDE;
	LZL	4	0	:M.ENDE KOMMT;
MPP10=	SU	UFUELL		:LESEPUFFER FUELLEN ODER LETZTES ZEICHEN BRINGEN;
MPP15=	BH	ZEILENENDE,
	BQ	VHGW1,
	MU	S	0	:AUSG.1,LESEPUFFER GEFUELLT;
MPP20=	SLN	MPP30	5	:DATEIEINGABE MIT 'NL' IM SATZ;
MPP25=	MU	S	2	:AUSGANG 3, KEIN LESEPUFFERENDE ABER ZEILEN/SATZENDE;
MPP30=	B	ZEILENENDE,
	R	BH	A,
	MU	S	1	:AUSG.2,DATEI MIT 'NL' IM SATZ;

UOADR=	TXR	A	XLW	:AUS LESEPEGEL ZEICHENADR. BEST.;
	A	AAP		:ADDIERE GEB ;
	R	SB2	DL,
	TXX	XH2	XLZ,
	VBA	'8003',
	SXK	3R,
	AA	1,
	XC	XH2,
	SH	ZU	22,
	TXR	A	XH2,
	IR	AB,
	SH	ZUL	22,
	LA	2,
	MU	S	0	:Z.-ADR. IN A-R;

UBNZADR=	R	TCB	A	:AUS ZEICHENADR. LESEPEGEL BESTIMMEN;
	SHB	L	2,
	SHB	R	2,
	VBC	GEB,
	HBC	AAP,
	LA	2,
	SH	A	22,
	SXRN	MADR10		:LINKES HW;
	VBA	1,
	SXN	2R,
	XBA	0		: +0;
	AA	3,
MADR10=	AA	'8000',
	XC	XLW,
	TRX	A	XLZ,
	MU	S	0	:LESEPEGEL IN XLZ XLW;

				---S&GZF, VARIABLEN--
XBAS=	ZONE	I,
	ABLAGE	XBAS	(V0),
BX=	0/1V,
	'8000'/HV,
	0/HV,
	0/V, 0/V, 0/V, 0/V, 0/V, 0/V,
	0/HV1			:INDEXSPEICHER;
RUECK=	0/HVU			: RUECKKEHRADR. TK1 VOR BASI;
BASI=	BX/AV,
	13/HV			:INDEXBASISADR. +UNTERPROGRAMMZAEHLER;
MERK=	0/HV			:MERKLICHTER;
EAO=	0/HV			: FREMDSTRINGENDADRESSE;
AAP=	0/HVG			:OP.REL. LESEPUFFERADR.;
GEB=	0/HV			:GEB.REL. ADR. 1.GW IM LESEPUFFER ;
ALPUFEND=	0/HV			: OP.REL. LESEPUFFERENDADR.;
ZPUFEND=	0/HV			: OP.REL. ZEILENPUFFERENDADR.;
FADR=	0/HVG			:FEHLERADRESSE;
AVBL=	0/HV			--RETTUNGSADR. ALTER VBL --
ALZP=	0/3V,
	HILF/3AV, 27/HV	:ANF.ADR.ZEILENPUFFER+LAENGE BEI DATEI;
NINF=	0/V			: NUMERIERUNGSINFORMATION;
NUM=	0/V			: ZEILENNUMMER;
LESPUEND=	0/2V			: GEB.REL. ZEICHENADR.+1 DES DURCH 'NL' ERSETZTEN Z.;
LZEICHEN=	0/3V			: ENTHAELT DAS ZULETZT DURCH 'NL' ERSETZTE ZEICHEN;
VHGW1=	0/3V			: HILFSGANZWORT;
VBDAT=	SSR1/AGV, 2/HV,
	REPL	V	(12),
	0/V2,
	REND,
VB368=	SSR1/AVG, 1/HV, 0/2V, 0/2V, 0/0V, 0/V	:VBL FUER 1/8-SEITENTRANSP.;
VBL616=	F0A/AG, 11/H, FTEXT/A, 5/H	: VBL FUER MELDUNG-ANF.AUFR.FEHLT;

FTEXT=	''*021ANFANGSAUFRUF VON S&GZF FEHLT'',
ENDNUM=	'3FFFFFFFFFFF'/1V,
HONUM=	'3FFFFFFFFFFF'/1,
TEXTENDE=	'25'/3,
ZEILENENDE=	'15'/3,
MASKE=	'FFFFFFFFFF00'/3,
K6=	6/1			: KONSTANTER DIVISOR;
W0=	0/2HVG,
W1=	0/HV,
W2=	0/HV,
W3=	0/HV			:OKTADENADR,WEICHE, HILF-1;
HILF=	ASP	0/VG,
	REPL	V	(27),
	0/3V,
	REND,
	AEND	(V0),
S&SSRQCR=	CZONE	V,
	ABLAGE	S&SSRQCR (V0),
SSRQCR=	ASP	12/G,
	AEND	(V0),

	ENDE,

